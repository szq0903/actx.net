{include file="Public/head_base" /}

{include file="Public/menu" /}

<div class="mainpanel">

    {include file="Public/headerbar" /}
    <script src="/zx-editor/libs/zx-debug.min.js"></script>
    <!--编辑器-->
    <script src="/zx-editor/js/zx-editor.min.js"></script>
    <style>
        .zxeditor-container.fixed .zxeditor-content-wrapper {
            position: inherit;
        }

        .zxeditor-container .zxeditor-toolbar-wrapper {
            position: inherit;
        }

        .zx-eidtor-container {
            border: 1px solid #d3d7db;
        }

        .zxeditor-container {
            background: #ffffff;
        }
    </style>

    <div class="pageheader">
        <h2><i class="fa fa-table"></i> 大转盘管理 <a class="btn btn-danger" href="{:url('index/lotterys/add')}">添加大转盘</a>
        </h2>
        <div class="breadcrumb-wrapper">
            <span class="label">当前位置:</span>
            <ol class="breadcrumb">
                <li><a href="/lotterys">大转盘管理</a></li>
                <li class="active">大转盘管理</li>
            </ol>
        </div>
    </div>

    <div class="contentpanel">

        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="panel-btns">
                    <a href="" class="panel-close">×</a>
                    <a href="" class="minimize">−</a>
                </div>
                <h4 class="panel-title">大转盘编辑</h4>

            </div>
            <div class="panel-body panel-body-nopadding" style="display: block;">

                <form method="post" name="myForm" class="form-horizontal form-bordered">
                    <link href="/template/fileinput/fileinput.css" media="all" rel="stylesheet" type="text/css"/>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">头部图片：</label>
                        <div class="col-sm-6">
                            <input id="qcode" name="toppic" value="{if isset($temp['toppic'])}{$temp['toppic']}{/if}" type="hidden">
                            <input id="file-zh" name="upqcode" value="{if isset($temp['toppic'])}{$temp['toppic']}{/if}" type="file" multiple>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">背景音乐：</label>
                        <div class="col-sm-6">
                            <input id="music" name="music" value="{if isset($temp['music'])}{$temp['music']}{/if}" type="hidden">
                            <input id="file-zh-music" name="upmusic" value="{if isset($temp['music'])}{$temp['music']}{/if}" type="file" multiple>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">标题：</label>
                        <div class="col-sm-6">
                            <input type="text" placeholder="标题" name="title"
                                   value="{if isset($temp['title'])}{$temp['title']}{/if}" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="disabledinput">开始时间：</label>
                        <div class="col-sm-6">
                            <div class="input-group">

                                <input type="text" class="form-control" name="startime" value="{if isset($temp['startime'])}{$temp['startime']}{/if}" placeholder="mm/dd/yyyy" id="datepicker">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>

                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="disabledinput">结束时间：</label>
                        <div class="col-sm-6">
                            <div class="input-group">

                                <input type="text" class="form-control" name="endtime" value="{if isset($temp['endtime'])}{$temp['endtime']}{/if}" placeholder="mm/dd/yyyy" id="datepicker1">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>

                        </div>
                    </div>


                    {volist name="formhtml" id="vo" mod="2"}
                    <div class="form-group">
                        <label class="col-sm-3 control-label">{$vo['itemname']}：</label>
                        <div class="col-sm-6" {if $vo['itemname']=='内容'}style="position: initial"{/if}>
                        {$vo['html']}
                    </div>
            </div>
            {/volist}


            <div class="form-group">
                <label class="col-sm-3 control-label">手机号：</label>
                <div class="col-sm-6">
                    <input type="text" placeholder="手机号" name="tel" value="{if isset($temp['tel'])}{$temp['tel']}{/if}" class="form-control">
                </div>
            </div>


            <div class="panel-footer" style="display: block;">
                <div class="row">
                    <div class="col-sm-6 col-sm-offset-3">

                        <button class="btn btn-primary" type="submit">提交</button>&nbsp;
                        <button class="btn btn-default" type="reset">取消</button>
                    </div>
                </div>
            </div><!-- panel-footer -->

        </div>

        </form>

    </div><!-- panel-body -->


    <!-- row -->
</div><!-- contentpanel -->

</div><!-- mainpanel -->







<script src="/template/js/jquery-1.11.1.min.js"></script>
<script src="/template/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/template/js/bootstrap.min.js"></script>
<script src="/template/js/modernizr.min.js"></script>
<script src="/template/js/jquery.sparkline.min.js"></script>
<script src="/template/js/toggles.min.js"></script>
<script src="/template/js/retina.min.js"></script>
<script src="/template/js/jquery.cookies.js"></script>


<script src="/template/js/jquery-ui-1.10.3.min.js"></script>
<!--<script src="/template/js/select2.min.js"></script>-->

<script src="/template/js/custom.js"></script>

<style>
    .form-control.file-caption.kv-fileinput-caption {
        padding: 7px;
    }

    .form-control.file-caption.kv-fileinput-caption .file-caption-name {
        line-height: 25px;
    }
</style>
<script src="/template/fileinput/fileinput.js" type="text/javascript"></script>
<script src="/template/fileinput/zh.js" type="text/javascript"></script>

<script>
    jQuery(document).ready(function () {

        "use strict";
        // Date Picker
        jQuery('#datepicker').datepicker();
        jQuery('#datepicker1').datepicker();
        jQuery('#datepicker2').datepicker();


        $("#sid").change(function () {
            var d = {"sid": $(this).val()};
            $.post("{:url('index/lotterys/ajaxsorttype')}", d, function (result) {
                var obj = JSON.parse(result);
                if (obj.status == 1) {
                    $("#content").hide();
                    $("#wechat").hide();
                    $("#address").hide();
                    $.each(obj.data, function (name, value) {
                        $("#" + name).show();
                        $("#" + name + "-title").html(value + "：");
                    });
                } else {
                    $("#sidinfo").html(obj.msg);
                }

            });
        });
    });
    $('#file-zh').fileinput({
        language: 'zh',
        uploadUrl: '/magents/addimg.html',
        allowedFileExtensions: ['jpg', 'png', 'gif','mp3'],
        showUploadedThumbs: true,
        previewFileType: 'any',
        dropZoneEnabled: false,
        overwriteInitial: false,
        maxFileCount: 1,
        initialPreviewFileType: 'image',//图像是默认的，可以在下面的配置中重写
        purifyHtml: true,//默认情况下会纯化HTML数据以进行预览
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>",

    {if isset($temp['toppic'])}
    initialPreview: [
        "<img src='{$temp['toppic']}'  class='kv-preview-data file-preview-image' style='width:auto;height:160px;'/>",
    ],
        initialPreviewConfig:[
        {
            caption: "{$temp['toppic']}",
            size: {$temp['imagesize']},
            width: "120px",
            url: '/magents/delimg.html',
            key: {$key+1},
            extra: {imgpath: '{$temp['toppic']}'}
        },
    ],
        initialCaption:'{$temp['toppic']}'
    {/if}
    }).on("fileuploaded", function (event, data, previewId, index) {
        var imgs = $('#qcode').val();
        imgs =data.response.data;
        $('#qcode').val(imgs);
        $(".file-caption-name").attr("title", imgs);
        var html = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>' + imgs;
        $(".file-caption-name").html(html);

    });
    $('#file-zh').on('filepredelete', function (event, key, jqXHR, data) {
        var str = $('#qcode').val();
        var splitFirst = str.split(',' + data.imgpath);
        var result = splitFirst.join('');
        $('#qcode').val(result);

        $(".file-caption-name").attr("title", result);
        var html = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>' + result;
        $(".file-caption-name").html(html);
        // console.log('Key = ' + key);
        // console.log(jqXHR);  
        //console.log(data); 
    });





    $('#file-zh-music').fileinput({
        language: 'zh',
        uploadUrl: '/magents/addimg.html',
        allowedFileExtensions: ['jpg', 'png', 'gif','mp3'],
        showUploadedThumbs: true,
        previewFileType: 'any',
        dropZoneEnabled: false,
        overwriteInitial: false,
        maxFileCount: 1,
        initialPreviewFileType: 'audio',//图像是默认的，可以在下面的配置中重写
        purifyHtml: true,//默认情况下会纯化HTML数据以进行预览
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>",

    {if isset($temp['music'])}
    initialPreview: [

        "<audio class=\"kv-preview-data\" controls=\"\">\n" +
        "<source src='{$temp['music']}' type=\"audio/mp3\">\n" +
        "<div class=\"file-preview-other\">\n" +
        "<span class=\"file-other-icon\"><i class=\"glyphicon glyphicon-king\"></i></span>\n" +
        "</div>\n" +
        "</audio>"
    ],
        initialPreviewConfig:[
        {
            caption: "{$temp['music']}",
            size: {$temp['musicsize']},
            type: "mp3",
            width: "120px",
            url: '/magents/delimg.html',
            key: {$key+1},
            extra: {imgpath: '{$temp['music']}'}
        },
    ],
        initialCaption:'{$temp['music']}'
    {/if}
    }).on("fileuploaded", function (event, data, previewId, index) {
        var imgs = $('#music').val();
        imgs = data.response.data;
        $('#music').val(imgs);
        $(".file-caption-name").attr("title", imgs);
        var html = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>' + imgs;
        $(".file-caption-name").html(html);

    });
    $('#file-zh-music').on('filepredelete', function (event, key, jqXHR, data) {
        var str = $('#music').val();
        var splitFirst = str.split(',' + data.imgpath);
        var result = splitFirst.join('');
        $('#music').val(result);

        $(".file-caption-name").attr("title", result);
        var html = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>' + result;
        $(".file-caption-name").html(html);
        // console.log('Key = ' + key);
        // console.log(jqXHR);
        //console.log(data);
    });
</script>

</body>
</html>


